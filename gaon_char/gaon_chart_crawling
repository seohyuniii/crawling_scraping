{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d238edc6",
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "from bs4 import BeautifulSoup\n",
    "from selenium import webdriver\n",
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f65129c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "#차트 페이지 열기\n",
    "browser = webdriver.Chrome('C:\\selenium\\chromedriver.exe')\n",
    "browser.get('http://www.gaonchart.co.kr/')\n",
    "browser.find_element_by_xpath('//*[@id=\"mainwrap\"]/div[1]/div[1]/div[1]/div[1]/div/a').click()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "33afa498",
   "metadata": {},
   "outputs": [],
   "source": [
    "#차트 크롤링할 함수 선언\n",
    "def chart_crawler():\n",
    "    #데이터프레임 준비\n",
    "    gaon_chart = pd.DataFrame({\n",
    "    '순위':[],\n",
    "    '변동':[],\n",
    "    '제목':[],\n",
    "    '가수':[],\n",
    "    '앨범':[],\n",
    "    '가온지수':[],\n",
    "    '제작사':[],\n",
    "    '유통사':[]\n",
    "    })\n",
    "\n",
    "    #순위\n",
    "    ranks = browser.find_elements_by_xpath('//td[@class=\"ranking\"]')\n",
    "\n",
    "    #변동(beautiful soup 이용)\n",
    "    req = requests.get(browser.current_url)\n",
    "    soup = BeautifulSoup(req.content, 'html.parser')\n",
    "    changes=[]\n",
    "    for i in soup.select('.change'):\n",
    "        if i.select('.up'):\n",
    "            if i.select('.up')=='HOT':\n",
    "                changes.append('HOT')\n",
    "            else:\n",
    "                changes.append(i.get_text()+' 상승')\n",
    "        elif i.select('.down'):\n",
    "            changes.append(i.get_text()+' 하락')\n",
    "        elif i.select('.new'):\n",
    "            changes.append('NEW')\n",
    "        else:\n",
    "            changes.append('변동 없음')\n",
    "\n",
    "\n",
    "    #제목\n",
    "    titles = browser.find_elements_by_xpath('//td[@class=\"subject\"]/p[1]')\n",
    "\n",
    "    #가수 & 앨범\n",
    "    singers_n_albums = browser.find_elements_by_xpath('//p[@class=\"singer\"]')\n",
    "\n",
    "    #가온지수\n",
    "    gaon_count = browser.find_elements_by_xpath('//td[@class=\"count\"]')\n",
    "\n",
    "    #제작사\n",
    "    production = browser.find_elements_by_xpath('//p[@class=\"pro\"]')\n",
    "\n",
    "    #유통사\n",
    "    distribution = browser.find_elements_by_xpath('//p[@class=\"dist\"]')\n",
    "\n",
    "    #가수와 앨범명 분리\n",
    "    singers = []\n",
    "    albums = []\n",
    "    for n in singers_n_albums:\n",
    "        if len((n.text).split('|'))==2:\n",
    "            singers.append((n.text).split('|')[0])\n",
    "            albums.append((n.text).split('|')[1])\n",
    "        else:\n",
    "            singers.append((n.text))\n",
    "            albums.append(np.nan)\n",
    "\n",
    "    #text 추출\n",
    "    for i in range(200):\n",
    "        ranks[i] = ranks[i].text\n",
    "        titles[i] = titles[i].text\n",
    "        gaon_count[i] = gaon_count[i].text\n",
    "        production[i] = production[i].text\n",
    "        distribution[i] = distribution[i].text\n",
    "         \n",
    "    #데이터프레임 만들기\n",
    "    insert_data = pd.DataFrame({\n",
    "        '순위':ranks,\n",
    "        '변동':changes,\n",
    "        '제목':titles,\n",
    "        '가수':singers,\n",
    "        '앨범':albums,\n",
    "        '가온지수':gaon_count,\n",
    "        '제작사':production,\n",
    "        '유통사':distribution\n",
    "    })\n",
    "\n",
    "    gaon_chart = gaon_chart.append(insert_data)\n",
    "    gaon_chart.set_index('순위', inplace=True)\n",
    "    \n",
    "    # 현재 열려있는 탭 종료\n",
    "    browser.close()\n",
    "\n",
    "    # 브라우저 전체 종료\n",
    "    browser.quit()\n",
    "    \n",
    "    return gaon_chart\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "a48b2dc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#차트 크롤링\n",
    "gaon_chart = chart_crawler()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7e362fd8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>변동</th>\n",
       "      <th>제목</th>\n",
       "      <th>가수</th>\n",
       "      <th>앨범</th>\n",
       "      <th>가온지수</th>\n",
       "      <th>제작사</th>\n",
       "      <th>유통사</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>순위</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Stay</td>\n",
       "      <td>The Kid LAROI, Justin Bieber</td>\n",
       "      <td>Stay</td>\n",
       "      <td>31,202,952</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>Sony Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>신호등</td>\n",
       "      <td>이무진</td>\n",
       "      <td>신호등</td>\n",
       "      <td>26,726,205</td>\n",
       "      <td>쇼플레이</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>aespa</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>21,282,805</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>바라만 본다</td>\n",
       "      <td>MSG워너비(M.O.M)</td>\n",
       "      <td>MSG워너비 1집</td>\n",
       "      <td>20,292,771</td>\n",
       "      <td>유야호</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>태연 (TAEYEON)</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>19,536,190</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>좋은 사람 있으면 소개시켜줘</td>\n",
       "      <td>조이 (JOY)</td>\n",
       "      <td>슬기로운 의사생활 OST Part 2</td>\n",
       "      <td>2,052,091</td>\n",
       "      <td>스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>62 하락</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국)</td>\n",
       "      <td>김종국</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국) OST</td>\n",
       "      <td>2,003,983</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Believer</td>\n",
       "      <td>Imagine Dragons</td>\n",
       "      <td>Evolve</td>\n",
       "      <td>2,000,505</td>\n",
       "      <td>KIDinaKORNER, Interscope Records</td>\n",
       "      <td>Universal Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>7 하락</td>\n",
       "      <td>Way Back Home</td>\n",
       "      <td>숀 (SHAUN)</td>\n",
       "      <td>Take</td>\n",
       "      <td>1,994,992</td>\n",
       "      <td>디씨톰엔터테인먼트</td>\n",
       "      <td>Warner Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>NEW</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구)</td>\n",
       "      <td>길구봉구</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구) OST</td>\n",
       "      <td>1,974,261</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>200 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        변동                      제목                            가수  \\\n",
       "순위                                                                 \n",
       "1    변동 없음                    Stay  The Kid LAROI, Justin Bieber   \n",
       "2    변동 없음                     신호등                           이무진   \n",
       "3    변동 없음              Next Level                         aespa   \n",
       "4    변동 없음                  바라만 본다                 MSG워너비(M.O.M)   \n",
       "5    변동 없음                 Weekend                  태연 (TAEYEON)   \n",
       "..     ...                     ...                           ...   \n",
       "196  변동 없음         좋은 사람 있으면 소개시켜줘                      조이 (JOY)   \n",
       "197  62 하락     눈물을 훔친다 (금혼령 X 김종국)                           김종국   \n",
       "198  변동 없음                Believer               Imagine Dragons   \n",
       "199   7 하락           Way Back Home                     숀 (SHAUN)   \n",
       "200    NEW  너 하나야 (낮에 뜨는 달 X 길구봉구)                          길구봉구   \n",
       "\n",
       "                             앨범        가온지수  \\\n",
       "순위                                            \n",
       "1                          Stay  31,202,952   \n",
       "2                           신호등  26,726,205   \n",
       "3                    Next Level  21,282,805   \n",
       "4                     MSG워너비 1집  20,292,771   \n",
       "5                       Weekend  19,536,190   \n",
       "..                          ...         ...   \n",
       "196        슬기로운 의사생활 OST Part 2   2,052,091   \n",
       "197     눈물을 훔친다 (금혼령 X 김종국) OST   2,003,983   \n",
       "198                      Evolve   2,000,505   \n",
       "199                        Take   1,994,992   \n",
       "200  너 하나야 (낮에 뜨는 달 X 길구봉구) OST   1,974,261   \n",
       "\n",
       "                                             제작사  \\\n",
       "순위                                                 \n",
       "1                                       Columbia   \n",
       "2                                           쇼플레이   \n",
       "3                               SM Entertainment   \n",
       "4                                            유야호   \n",
       "5                               SM Entertainment   \n",
       "..                                           ...   \n",
       "196  스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment   \n",
       "197                                  TOON STUDIO   \n",
       "198             KIDinaKORNER, Interscope Records   \n",
       "199                                    디씨톰엔터테인먼트   \n",
       "200                                  TOON STUDIO   \n",
       "\n",
       "                                 유통사  \n",
       "순위                                    \n",
       "1                         Sony Music  \n",
       "2                Kakao Entertainment  \n",
       "3                            Dreamus  \n",
       "4    지니뮤직, Stone Music Entertainment  \n",
       "5                            Dreamus  \n",
       "..                               ...  \n",
       "196  지니뮤직, Stone Music Entertainment  \n",
       "197  지니뮤직, Stone Music Entertainment  \n",
       "198                  Universal Music  \n",
       "199                     Warner Music  \n",
       "200              Kakao Entertainment  \n",
       "\n",
       "[200 rows x 7 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gaon_chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "eaecdac0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "변동      0\n",
       "제목      0\n",
       "가수      0\n",
       "앨범      2\n",
       "가온지수    0\n",
       "제작사     0\n",
       "유통사     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#결측치 확인\n",
    "gaon_chart.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1da267db",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "순위\n",
       "69    NaN\n",
       "93    NaN\n",
       "Name: 앨범, dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#앨범 결측치 확인\n",
    "gaon_chart['앨범'][gaon_chart['앨범'].isnull()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "760ced39",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>가수</th>\n",
       "      <th>앨범</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>순위</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>MSG워너비 TOP 8 (별루지, 김정수, 강창모, 정기석, 이동휘, 이상이, 박재...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>미란이 (Mirani), 먼치맨, Khundi Panda, 머쉬베놈 (MUSHVEN...</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                   가수   앨범\n",
       "순위                                                        \n",
       "69  MSG워너비 TOP 8 (별루지, 김정수, 강창모, 정기석, 이동휘, 이상이, 박재...  NaN\n",
       "93  미란이 (Mirani), 먼치맨, Khundi Panda, 머쉬베놈 (MUSHVEN...  NaN"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#비어있는 부분 확인\n",
    "gaon_chart.loc[['69','93'],['가수','앨범']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "d91aedf6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#결측치를 채워줄 함수 선언\n",
    "def missing_data(gaon_chart):\n",
    "    #앨범 결측치 확인\n",
    "    album_loss = gaon_chart['앨범'][gaon_chart['앨범'].isnull()]\n",
    "\n",
    "    #해당되는 앨범의 곡명 추출\n",
    "    loss_list=[]\n",
    "    loss_singers=[]\n",
    "    for i in range(len(album_loss)):\n",
    "        loss_list.append(gaon_chart['제목'][album_loss.index[i]])\n",
    "        loss_singers.append(gaon_chart['가수'][album_loss.index[i]])\n",
    "    \n",
    "    #곡의 가수와 앨범명 찾기\n",
    "    browser2 = webdriver.Chrome('C:\\selenium\\chromedriver.exe')\n",
    "    browser2.get('https://www.naver.com/')\n",
    "    albums_new=[]\n",
    "    singers_new=[]\n",
    "    for i in range(len(loss_list)):\n",
    "        search = browser2.find_element_by_xpath('//*[@id=\"query\"]')\n",
    "        search.send_keys(loss_list[i]+loss_singers[i])\n",
    "        search.submit()\n",
    "        albums_new.append(browser2.find_element_by_xpath('//div[@class=\"dsc_area\"]/span[1]').text)\n",
    "        singers_new.append(browser2.find_element_by_xpath('//div[@class=\"dsc_area\"]/span[2]').text)\n",
    "        browser2.back()\n",
    "    \n",
    "    # 현재 열려있는 탭 종료\n",
    "    browser2.close()\n",
    "\n",
    "    # 브라우저 전체 종료\n",
    "    browser2.quit()\n",
    "    \n",
    "    #결측치 채우기\n",
    "    for i in range(len(loss_list)):\n",
    "        gaon_chart.loc[album_loss.index[i], '앨범'] = albums_new[i]\n",
    "        gaon_chart.loc[album_loss.index[i], '가수'] = singers_new[i]\n",
    "    \n",
    "    return gaon_chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "8857ebf4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#결측치 채우기\n",
    "gaon_chart = missing_data(gaon_chart)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b0821446",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "변동      0\n",
       "제목      0\n",
       "가수      0\n",
       "앨범      0\n",
       "가온지수    0\n",
       "제작사     0\n",
       "유통사     0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#결측치 확인\n",
    "gaon_chart.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "45414a93",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>가수</th>\n",
       "      <th>앨범</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>순위</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>69</th>\n",
       "      <td>MSG워너비 TOP 8(별루지, 김정수, 강창모, 정기석, 이동휘, 이상이, 박재정...</td>\n",
       "      <td>MSG워너비 TOP 8 경연곡</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>미란이(Mirani), 먼치맨(MUNCHMAN), 쿤디판다(Khundi Panda)...</td>\n",
       "      <td>쇼미더머니 9 Episode 1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                   가수                 앨범\n",
       "순위                                                                      \n",
       "69  MSG워너비 TOP 8(별루지, 김정수, 강창모, 정기석, 이동휘, 이상이, 박재정...   MSG워너비 TOP 8 경연곡\n",
       "93  미란이(Mirani), 먼치맨(MUNCHMAN), 쿤디판다(Khundi Panda)...  쇼미더머니 9 Episode 1"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#채워진 부분 확인\n",
    "gaon_chart.loc[['69','93'],['가수','앨범']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "10a9d7d9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>변동</th>\n",
       "      <th>제목</th>\n",
       "      <th>가수</th>\n",
       "      <th>앨범</th>\n",
       "      <th>가온지수</th>\n",
       "      <th>제작사</th>\n",
       "      <th>유통사</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>순위</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Stay</td>\n",
       "      <td>The Kid LAROI, Justin Bieber</td>\n",
       "      <td>Stay</td>\n",
       "      <td>31,202,952</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>Sony Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>신호등</td>\n",
       "      <td>이무진</td>\n",
       "      <td>신호등</td>\n",
       "      <td>26,726,205</td>\n",
       "      <td>쇼플레이</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>aespa</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>21,282,805</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>바라만 본다</td>\n",
       "      <td>MSG워너비(M.O.M)</td>\n",
       "      <td>MSG워너비 1집</td>\n",
       "      <td>20,292,771</td>\n",
       "      <td>유야호</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>태연 (TAEYEON)</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>19,536,190</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>좋은 사람 있으면 소개시켜줘</td>\n",
       "      <td>조이 (JOY)</td>\n",
       "      <td>슬기로운 의사생활 OST Part 2</td>\n",
       "      <td>2,052,091</td>\n",
       "      <td>스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>62 하락</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국)</td>\n",
       "      <td>김종국</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국) OST</td>\n",
       "      <td>2,003,983</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Believer</td>\n",
       "      <td>Imagine Dragons</td>\n",
       "      <td>Evolve</td>\n",
       "      <td>2,000,505</td>\n",
       "      <td>KIDinaKORNER, Interscope Records</td>\n",
       "      <td>Universal Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>7 하락</td>\n",
       "      <td>Way Back Home</td>\n",
       "      <td>숀 (SHAUN)</td>\n",
       "      <td>Take</td>\n",
       "      <td>1,994,992</td>\n",
       "      <td>디씨톰엔터테인먼트</td>\n",
       "      <td>Warner Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>NEW</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구)</td>\n",
       "      <td>길구봉구</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구) OST</td>\n",
       "      <td>1,974,261</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>200 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        변동                      제목                            가수  \\\n",
       "순위                                                                 \n",
       "1    변동 없음                    Stay  The Kid LAROI, Justin Bieber   \n",
       "2    변동 없음                     신호등                           이무진   \n",
       "3    변동 없음              Next Level                         aespa   \n",
       "4    변동 없음                  바라만 본다                 MSG워너비(M.O.M)   \n",
       "5    변동 없음                 Weekend                  태연 (TAEYEON)   \n",
       "..     ...                     ...                           ...   \n",
       "196  변동 없음         좋은 사람 있으면 소개시켜줘                      조이 (JOY)   \n",
       "197  62 하락     눈물을 훔친다 (금혼령 X 김종국)                           김종국   \n",
       "198  변동 없음                Believer               Imagine Dragons   \n",
       "199   7 하락           Way Back Home                     숀 (SHAUN)   \n",
       "200    NEW  너 하나야 (낮에 뜨는 달 X 길구봉구)                          길구봉구   \n",
       "\n",
       "                             앨범        가온지수  \\\n",
       "순위                                            \n",
       "1                          Stay  31,202,952   \n",
       "2                           신호등  26,726,205   \n",
       "3                    Next Level  21,282,805   \n",
       "4                     MSG워너비 1집  20,292,771   \n",
       "5                       Weekend  19,536,190   \n",
       "..                          ...         ...   \n",
       "196        슬기로운 의사생활 OST Part 2   2,052,091   \n",
       "197     눈물을 훔친다 (금혼령 X 김종국) OST   2,003,983   \n",
       "198                      Evolve   2,000,505   \n",
       "199                        Take   1,994,992   \n",
       "200  너 하나야 (낮에 뜨는 달 X 길구봉구) OST   1,974,261   \n",
       "\n",
       "                                             제작사  \\\n",
       "순위                                                 \n",
       "1                                       Columbia   \n",
       "2                                           쇼플레이   \n",
       "3                               SM Entertainment   \n",
       "4                                            유야호   \n",
       "5                               SM Entertainment   \n",
       "..                                           ...   \n",
       "196  스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment   \n",
       "197                                  TOON STUDIO   \n",
       "198             KIDinaKORNER, Interscope Records   \n",
       "199                                    디씨톰엔터테인먼트   \n",
       "200                                  TOON STUDIO   \n",
       "\n",
       "                                 유통사  \n",
       "순위                                    \n",
       "1                         Sony Music  \n",
       "2                Kakao Entertainment  \n",
       "3                            Dreamus  \n",
       "4    지니뮤직, Stone Music Entertainment  \n",
       "5                            Dreamus  \n",
       "..                               ...  \n",
       "196  지니뮤직, Stone Music Entertainment  \n",
       "197  지니뮤직, Stone Music Entertainment  \n",
       "198                  Universal Music  \n",
       "199                     Warner Music  \n",
       "200              Kakao Entertainment  \n",
       "\n",
       "[200 rows x 7 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gaon_chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "5fc0bde0",
   "metadata": {},
   "outputs": [],
   "source": [
    "#csv 파일로 저장\n",
    "gaon_chart.to_csv('gaon_chart.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "7cb5af8e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>변동</th>\n",
       "      <th>제목</th>\n",
       "      <th>가수</th>\n",
       "      <th>앨범</th>\n",
       "      <th>가온지수</th>\n",
       "      <th>제작사</th>\n",
       "      <th>유통사</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>순위</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Stay</td>\n",
       "      <td>The Kid LAROI, Justin Bieber</td>\n",
       "      <td>Stay</td>\n",
       "      <td>31,202,952</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>Sony Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>신호등</td>\n",
       "      <td>이무진</td>\n",
       "      <td>신호등</td>\n",
       "      <td>26,726,205</td>\n",
       "      <td>쇼플레이</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>aespa</td>\n",
       "      <td>Next Level</td>\n",
       "      <td>21,282,805</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>바라만 본다</td>\n",
       "      <td>MSG워너비(M.O.M)</td>\n",
       "      <td>MSG워너비 1집</td>\n",
       "      <td>20,292,771</td>\n",
       "      <td>유야호</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>태연 (TAEYEON)</td>\n",
       "      <td>Weekend</td>\n",
       "      <td>19,536,190</td>\n",
       "      <td>SM Entertainment</td>\n",
       "      <td>Dreamus</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>196</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>좋은 사람 있으면 소개시켜줘</td>\n",
       "      <td>조이 (JOY)</td>\n",
       "      <td>슬기로운 의사생활 OST Part 2</td>\n",
       "      <td>2,052,091</td>\n",
       "      <td>스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>197</th>\n",
       "      <td>62 하락</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국)</td>\n",
       "      <td>김종국</td>\n",
       "      <td>눈물을 훔친다 (금혼령 X 김종국) OST</td>\n",
       "      <td>2,003,983</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>지니뮤직, Stone Music Entertainment</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>198</th>\n",
       "      <td>변동 없음</td>\n",
       "      <td>Believer</td>\n",
       "      <td>Imagine Dragons</td>\n",
       "      <td>Evolve</td>\n",
       "      <td>2,000,505</td>\n",
       "      <td>KIDinaKORNER, Interscope Records</td>\n",
       "      <td>Universal Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>199</th>\n",
       "      <td>7 하락</td>\n",
       "      <td>Way Back Home</td>\n",
       "      <td>숀 (SHAUN)</td>\n",
       "      <td>Take</td>\n",
       "      <td>1,994,992</td>\n",
       "      <td>디씨톰엔터테인먼트</td>\n",
       "      <td>Warner Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>200</th>\n",
       "      <td>NEW</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구)</td>\n",
       "      <td>길구봉구</td>\n",
       "      <td>너 하나야 (낮에 뜨는 달 X 길구봉구) OST</td>\n",
       "      <td>1,974,261</td>\n",
       "      <td>TOON STUDIO</td>\n",
       "      <td>Kakao Entertainment</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>200 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        변동                      제목                            가수  \\\n",
       "순위                                                                 \n",
       "1    변동 없음                    Stay  The Kid LAROI, Justin Bieber   \n",
       "2    변동 없음                     신호등                           이무진   \n",
       "3    변동 없음              Next Level                         aespa   \n",
       "4    변동 없음                  바라만 본다                 MSG워너비(M.O.M)   \n",
       "5    변동 없음                 Weekend                  태연 (TAEYEON)   \n",
       "..     ...                     ...                           ...   \n",
       "196  변동 없음         좋은 사람 있으면 소개시켜줘                      조이 (JOY)   \n",
       "197  62 하락     눈물을 훔친다 (금혼령 X 김종국)                           김종국   \n",
       "198  변동 없음                Believer               Imagine Dragons   \n",
       "199   7 하락           Way Back Home                     숀 (SHAUN)   \n",
       "200    NEW  너 하나야 (낮에 뜨는 달 X 길구봉구)                          길구봉구   \n",
       "\n",
       "                             앨범        가온지수  \\\n",
       "순위                                            \n",
       "1                          Stay  31,202,952   \n",
       "2                           신호등  26,726,205   \n",
       "3                    Next Level  21,282,805   \n",
       "4                     MSG워너비 1집  20,292,771   \n",
       "5                       Weekend  19,536,190   \n",
       "..                          ...         ...   \n",
       "196        슬기로운 의사생활 OST Part 2   2,052,091   \n",
       "197     눈물을 훔친다 (금혼령 X 김종국) OST   2,003,983   \n",
       "198                      Evolve   2,000,505   \n",
       "199                        Take   1,994,992   \n",
       "200  너 하나야 (낮에 뜨는 달 X 길구봉구) OST   1,974,261   \n",
       "\n",
       "                                             제작사  \\\n",
       "순위                                                 \n",
       "1                                       Columbia   \n",
       "2                                           쇼플레이   \n",
       "3                               SM Entertainment   \n",
       "4                                            유야호   \n",
       "5                               SM Entertainment   \n",
       "..                                           ...   \n",
       "196  스튜디오 마음C, 에그이즈커밍, Stone Music Entertainment   \n",
       "197                                  TOON STUDIO   \n",
       "198             KIDinaKORNER, Interscope Records   \n",
       "199                                    디씨톰엔터테인먼트   \n",
       "200                                  TOON STUDIO   \n",
       "\n",
       "                                 유통사  \n",
       "순위                                    \n",
       "1                         Sony Music  \n",
       "2                Kakao Entertainment  \n",
       "3                            Dreamus  \n",
       "4    지니뮤직, Stone Music Entertainment  \n",
       "5                            Dreamus  \n",
       "..                               ...  \n",
       "196  지니뮤직, Stone Music Entertainment  \n",
       "197  지니뮤직, Stone Music Entertainment  \n",
       "198                  Universal Music  \n",
       "199                     Warner Music  \n",
       "200              Kakao Entertainment  \n",
       "\n",
       "[200 rows x 7 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#다시 불러와서 확인\n",
    "gaon_chart2 = pd.read_csv('gaon_chart.csv', index_col=0)\n",
    "gaon_chart2"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
